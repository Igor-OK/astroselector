'use strict';const urlParams=new URLSearchParams(window.location.search),searchDay=parseInt(urlParams.get("d1")),searchMonth=parseInt(urlParams.get("m1")),searchYear=parseInt(urlParams.get("y1")),searchYearStart=parseInt(urlParams.get("ys1")),searchYearEnd=parseInt(urlParams.get("ye1")),activeDay=parseInt(urlParams.get("d0")),activeMonth=parseInt(urlParams.get("m0")),activeYear=parseInt(urlParams.get("y0")),activeName=urlParams.get("name"),sex=parseInt(urlParams.get("s")),scene=document.getElementById("scene"),activeNameBlock=document.getElementById("name"),activeBirthdayBlock=document.getElementById("birthday"),statusBlock=document.getElementById("status-block"),runningDaysBlock=document.getElementById("days"),runningMonthsBlock=document.getElementById("month"),runningYearsBlock=document.getElementById("years"),yearsTicksBlock=document.getElementById("years-ticks"),zoomer=document.getElementById("zoomer"),sMap=document.getElementById("s-natal-map"),aAvatar=document.getElementById("a-avatar"),sAvatar=document.getElementById("s-avatar"),restart=document.getElementById("restart"),rusMonths=[null,"\u044F\u043D\u0432\u0430\u0440\u044F","\u0444\u0435\u0432\u0440\u0430\u043B\u044F","\u043C\u0430\u0440\u0442\u0430","\u0430\u043F\u0440\u0435\u043B\u044F","\u043C\u0430\u044F","\u0438\u044E\u043D\u044F","\u0438\u044E\u043B\u044F","\u0430\u0432\u0433\u0443\u0441\u0442\u0430","\u0441\u0435\u043D\u0442\u044F\u0431\u0440\u044F","\u043E\u043A\u0442\u044F\u0431\u0440\u044F","\u043D\u043E\u044F\u0431\u0440\u044F","\u0434\u0435\u043A\u0430\u0431\u0440\u044F"],searchColumns=[220,200,250,230,250,170,140];searchColumns[0]=Math.floor(2.5*parseInt(urlParams.get("p1"))),searchColumns[1]=Math.floor(2.5*parseInt(urlParams.get("p2"))),searchColumns[2]=Math.floor(2.5*parseInt(urlParams.get("p3"))),searchColumns[3]=Math.floor(2.5*parseInt(urlParams.get("p4"))),searchColumns[4]=Math.floor(2.5*parseInt(urlParams.get("p5"))),searchColumns[5]=Math.floor(2.5*parseInt(urlParams.get("p6"))),searchColumns[6]=Math.floor(2.5*parseInt(urlParams.get("p7")));let yearsTicksBlockInnerHtml=``;for(let a=searchYearStart;a<=searchYearEnd;a++)yearsTicksBlockInnerHtml+=`<span class="year-tick" data-year="${a}">- ${a}</span>`;yearsTicksBlock.innerHTML=yearsTicksBlockInnerHtml,activeNameBlock.innerText=activeName,activeBirthdayBlock.innerHTML=`<span class="birthday-item">${activeDay}</span>
								 <span class="birthday-item month">${rusMonths[activeMonth]}</span>
								 <span class="birthday-item">${activeYear}</span>`;const aboutFemaleWords=["\u0434\u0430\u043B\u0430 \u0434\u0435\u0432\u0443\u0448\u043A\u0430","\u043A\u043E\u0442\u043E\u0440\u0430\u044F","\u043D\u0435\u0439","\u0434\u0435\u0432\u0443\u0448\u043A\u0443"],aboutMaleWords=["\u0434\u0430\u043B \u043C\u043E\u043B\u043E\u0434\u043E\u0439 \u0447\u0435\u043B\u043E\u0432\u0435\u043A","\u043A\u043E\u0442\u043E\u0440\u044B\u0439","\u043D\u0438\u043C","\u043C\u043E\u043B\u043E\u0434\u043E\u0433\u043E \u0447\u0435\u043B\u043E\u0432\u0435\u043A\u0430"],currentWords=sex?aboutMaleWords:aboutFemaleWords,startInfo=`<h1>Если вы родились <strong>${searchDay}&nbsp;${rusMonths[searchMonth]}&nbsp;${searchYear}</strong>,</br> для Вас есть прекрасная новость!</h1>
	<p>Раз уж именно Вам посчастливилось оказаться на этой странице, знайте - ссылку на неё Вам ${currentWords[0]} <strong>${activeName}</strong>, ${currentWords[1]} настолько хорошо Вам подходит, что после встречи с ${currentWords[2]} Вы гарантированно потеряете покой в ожидании новой встречи. Шанс повстречать такого человека (на промежутке 10 лет) - всего 1/3650.</p>
	<p>Потенциальная совместимость может содержать лишь незначитеьное количество нехороших моментов, но ОБЯЗАТЕЛЬНО содержит сильное взаимное притяжение, небывалое понимание, уважение и обоюдную радость. </p>
	<p>Внимание! Если Вы уже в отношениях или в браке - закройте страницу, поблагодарите ${currentWords[3]} за внимание и попрощайтесь.</p>`;document.getElementById("pre-story").innerHTML=startInfo;const setSearcBlockValues=(a,b,c)=>{runningDaysBlock.innerHTML=a,runningMonthsBlock.innerHTML=b,runningYearsBlock.innerHTML=c};let timerId1,timerId2,timerId3,monthsTimerId,yearsTimerId,inProcess=!0;const startAnimation=()=>{setSearcBlockValues("01",rusMonths[0],searchYearStart);const a=sex?["m-active-1","m-active-2","w-search-1","w-search-2"]:["w-active-1","w-active-2","m-search-1","m-search-2"];aAvatar.classList.remove(a[1]),aAvatar.classList.add(a[0]),sAvatar.classList.remove(a[3]),sAvatar.classList.add(a[2]);let b=0,c=0;const d=a=>{inProcess&&(a.innerHTML=""+b+c,b++,c++,3<b&&(b=0),9<c&&(c=0),setTimeout(d,50,a))};let e=1;const f=(a,b)=>{inProcess&&(a.innerHTML=b[e],e++,12<e&&(e=1),monthsTimerId=setTimeout(f,100,a,b))},g=1e3*10/Math.abs(searchYearEnd-searchYearStart);let h=searchYearStart;const i=a=>{if(inProcess)return a.innerHTML=h,h++,h>searchYearEnd?void(inProcess=!1):void(yearsTimerId=setTimeout(i,g,a))};sMap.classList.add("s-natal-map"),setTimeout(()=>{zoomer.classList.add("run")},50);const j=20,k=250,l=(a,b,c)=>{const d=(b+a)/2,e=0,f=c<=d?255:parseInt(255-255*Math.abs(d-c)/Math.abs(b-d)),g=c>=d?255:parseInt(255-255*Math.abs(c-d)/Math.abs(d-a)),h=0>f-70?0:f-70,i=0>g-70?0:g-70;return[`rgb(${f}, ${g}, ${e})`,`rgb(${h}, ${i}, ${e})`]},m=(a,b)=>{let c=Math.floor(Math.random()*(b-a)+a);return c},n=(a,b,c,d)=>{a[b]+=m(-50,50),a[b]>d&&(a[b]=d),a[b]<j&&(a[b]=j);const e=l(j,k,a[b]),f=document.querySelector(".head-"+(b+1));c.style.height=a[b]+"px",c.style.background=`linear-gradient(90deg, ${e[1]}, ${e[0]})`,f.style.backgroundColor=e[0],f.style.borderColor=e[1]},o=a=>{if(!inProcess)return!1;for(let b=0;b<a.length;b++)n(a,b,document.getElementById("indicator-"+(b+1)),200);setTimeout(o,50,a)};d(runningDaysBlock),f(runningMonthsBlock,rusMonths),i(runningYearsBlock),o([100,70,25,40,30,35,60]);const p=(a,b,c,d)=>{const e=475/Math.abs(d-c);return(a-c)*e+e*b/12};timerId1=setTimeout(()=>{setSearcBlockValues("","",""),sMap.classList.add("loading"),statusBlock.innerHTML=""},10200),timerId2=setTimeout(()=>{zoomer.classList.add("winner"),zoomer.style.top=p(searchYear,searchMonth,searchYearStart,searchYearEnd)-25+"px";const a=document.getElementsByClassName("column");for(let b=0;b<a.length;b++){const c=document.querySelector(".head-"+(b+1)),d=l(j,k,searchColumns[b]);a[b].classList.add("column-winner"),c.classList.add("head-winner"),a[b].style.height=searchColumns[b]+"px",a[b].style.background=`linear-gradient(90deg, ${d[1]}, ${d[0]})`,c.style.backgroundColor=d[0],c.style.borderColor=d[1]}},11e3),timerId3=setTimeout(()=>{setSearcBlockValues(searchDay,rusMonths[searchMonth],searchYear),sMap.classList.add("finish"),statusBlock.innerHTML="\u0421\u0430\u043C\u0430\u044F \u043B\u0443\u0447\u0448\u0430\u044F \u0441\u043E\u0432\u043C\u0435\u0441\u0442\u0438\u043C\u043E\u0441\u0442\u044C:",aAvatar.classList.remove(a[0]),aAvatar.classList.add(a[1]),sAvatar.classList.remove(a[2]),sAvatar.classList.add(a[3])},12e3)};startAnimation();const restartAnimation=()=>{inProcess=!1,clearTimeout(timerId1),clearTimeout(timerId2),clearTimeout(timerId3),clearTimeout(monthsTimerId),clearTimeout(yearsTimerId),zoomer.removeAttribute("style"),zoomer.classList.remove("run"),zoomer.classList.remove("winner"),sMap.classList.remove("finish"),sMap.classList.remove("loading"),statusBlock.innerHTML="\u0418\u0434\u0451\u0442 \u043F\u043E\u0438\u0441\u043A <br/> \u0438 \u0430\u043D\u0430\u043B\u0438\u0437 ...";const a=document.getElementsByClassName("column");for(let b=0;b<a.length;b++){const c=document.querySelector(".head-"+(b+1));a[b].classList.remove("column-winner"),c.classList.remove("head-winner"),a[b].removeAttribute("style"),c.removeAttribute("style")}setTimeout(()=>{inProcess=!0,startAnimation()},100)};restart.addEventListener("click",restartAnimation);